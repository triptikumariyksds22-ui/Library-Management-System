<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Library Book Maintenance</title>
<style>
body { font-family: Arial, sans-serif; background:#f4f6f8; margin:0; text-align:center;}
header { background:#007bff; color:white; padding:20px 0; font-size:24px;}
nav { background:#e9ecef; padding:15px; }
nav a { margin:10px; text-decoration:none; color:#007bff; font-weight:bold;}
nav a:hover { text-decoration:underline;}
.content { margin:30px auto; max-width:1000px; text-align:left; }
table { width:100%; border-collapse:collapse; margin-top:10px; }
th, td { border:1px solid #dee2e6; padding:8px; text-align:center; }
th { background:#007bff; color:white; }
button { padding:4px 8px; border:none; border-radius:4px; cursor:pointer; margin:2px;}
.add-btn {background:#28a745; color:white;}
.delete-btn {background:#dc2626; color:white;}
.update-btn {background:#ffc107; color:white;}
input[type="text"], input[type="number"] { width:100px; padding:4px; }
.checkbox { width:20px; height:20px; }
</style>
</head>
<body>

<header>Library Book Maintenance</header>
<nav>
  <a href="admin dashboard.html">Dashboard</a>
  <a href="book_maintenance.html">Book Maintenance</a>
  <a href="#" onclick="logout()">Logout</a>
</nav>

<div class="content">
<h2>Book Inventory</h2>
<button class="add-btn" onclick="addBook()">Add Book</button>
<table id="booksTable">
  <thead>
    <tr>
      <th>Book ID</th>
      <th>Title</th>
      <th>Author</th>
      <th>Quantity</th>
      <th>Available</th>
      <th>Action</th>
    </tr>
  </thead>
  <tbody></tbody>
</table>
</div>

<script>
// Only admin access
let role = localStorage.getItem("role");
if(role!=='admin'){ alert("Access Denied!"); window.location.href="login.html"; }

// Load books from localStorage
let books = JSON.parse(localStorage.getItem("books")) || [
  {id:"BK101", title:"C Programming", author:"Dennis Ritchie", quantity:5, available:true},
  {id:"BK102", title:"Python Basics", author:"Guido van Rossum", quantity:3, available:true}
];

function logout(){ alert("Thank you!"); localStorage.removeItem("role"); window.location.href="login.html"; }

function saveBooks(){ localStorage.setItem("books", JSON.stringify(books)); }

function renderBooks(){
  let tbody = document.querySelector("#booksTable tbody");
  tbody.innerHTML="";
  books.forEach((b,i)=>{
    const tr = document.createElement("tr");
    tr.innerHTML = `
      <td>${b.id}</td>
      <td>${b.title}</td>
      <td>${b.author}</td>
      <td>${b.quantity}</td>
      <td><input type="checkbox" class="checkbox" ${b.available?"checked":""} onchange="toggleAvailable(${i}, this)"></td>
      <td>
        <button class="update-btn" onclick="updateBook(${i})">Update</button>
        <button class="delete-btn" onclick="deleteBook(${i})">Delete</button>
      </td>
    `;
    tbody.appendChild(tr);
  });
}

// Add book
function addBook(){
  const id = prompt("Enter Book ID:");
  const title = prompt("Enter Book Title:");
  const author = prompt("Enter Author Name:");
  const qty = prompt("Enter Quantity:");
  if(!id || !title || !author || !qty) return;
  books.push({id, title, author, quantity: parseInt(qty), available: parseInt(qty)>0});
  saveBooks();
  renderBooks();
}

// Update book quantity
function updateBook(i){
  let qty = prompt("Update Quantity:", books[i].quantity);
  if(qty!==null){
    books[i].quantity = parseInt(qty);
    books[i].available = books[i].quantity>0;
    saveBooks();
    renderBooks();
  }
}

// Delete book
function deleteBook(i){
  if(confirm("Are you sure you want to delete this book?")){
    books.splice(i,1);
    saveBooks();
    renderBooks();
  }
}

// Toggle availability
function toggleAvailable(i, el){
  books[i].available = el.checked;
  saveBooks();
}

// Initial render
renderBooks();
</script>

</body>
</html>
